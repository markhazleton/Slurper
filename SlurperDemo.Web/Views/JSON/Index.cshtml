@{
    ViewData["Title"] = "?? JSON Enigma Investigation";
}

<style>
    .slurp-effect {
        position: relative;
        overflow: hidden;
    }
    
    .slurp-effect::before {
        content: '??';
        position: absolute;
        top: 50%;
        left: -100%;
        transform: translateY(-50%);
        font-size: 3em;
        animation: slurping 3s ease-in-out infinite;
        z-index: 1;
    }
    
    @@keyframes slurping {
        0% { left: -100%; opacity: 0; }
        25% { opacity: 1; }
        75% { opacity: 1; }
        100% { left: 100%; opacity: 0; }
    }
    
    .investigation-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 40px 0;
        margin: -20px -15px 30px -15px;
        clip-path: polygon(0 0, 100% 0, 100% 85%, 0 100%);
    }
    
    .evidence-box {
        background: rgba(255,255,255,0.95);
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 10px 30px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
    }
    
    .evidence-box:hover {
        transform: translateY(-5px);
        box-shadow: 0 20px 40px rgba(0,0,0,0.2);
    }
    
    .extraction-step {
        background: linear-gradient(45deg, #4ecdc4, #44a08d);
        color: white;
        border-radius: 10px;
        padding: 15px;
        margin: 10px 0;
        position: relative;
        animation: fadeInUp 0.5s ease forwards;
        opacity: 0;
        transform: translateY(20px);
    }
    
    .extraction-step:nth-child(1) { animation-delay: 0.2s; }
    .extraction-step:nth-child(2) { animation-delay: 0.4s; }
    .extraction-step:nth-child(3) { animation-delay: 0.6s; }
    .extraction-step:nth-child(4) { animation-delay: 0.8s; }
    .extraction-step:nth-child(5) { animation-delay: 1.0s; }
    
    @@keyframes fadeInUp {
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }
    
    .hero-display {
        background: linear-gradient(135deg, #ffecd2 0%, #fcb69f 100%);
        border-radius: 15px;
        margin-bottom: 15px;
        padding: 20px;
        border: none;
        box-shadow: 0 8px 25px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
    }
    
    .hero-display:hover {
        transform: translateY(-3px) rotateY(5deg);
        box-shadow: 0 15px 35px rgba(0,0,0,0.2);
    }
    
    .code-comparison {
        background: #1e1e1e;
        border-radius: 10px;
        overflow: hidden;
    }
    
    .code-header {
        background: #333;
        color: white;
        padding: 15px;
        font-weight: bold;
    }
    
    .code-content {
        color: #d4d4d4;
        padding: 20px;
        font-family: 'Courier New', monospace;
        line-height: 1.6;
    }
    
    .pulse { animation: pulse 2s infinite; }
    @@keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
</style>

<div class="investigation-header text-center">
    <h1 class="display-3">?? JSON Enigma Investigation ??</h1>
    <p class="lead fs-4">
        <span class="badge bg-light text-dark pulse">
            ?? Case File #002: Classified Intelligence Extraction ??
        </span>
    </p>
    <p class="mt-3">Detective, your mission is to extract superhero intelligence from encrypted JSON files!</p>
</div>

<div class="container">
    <div class="card mb-4 evidence-box">
        <div class="card-header bg-primary text-white">
            <h3>?? Investigation Briefing</h3>
        </div>
        <div class="card-body">
            <p class="lead">This case demonstrates extracting superhero data from a JSON file using WebSpark.Slurper's JSON
                extractor. Watch as we decode the encrypted intelligence files with before/after analysis.</p>

            @if (ViewBag.SlurperExplanation != null)
            {
                <div class="alert alert-info">
                    @Html.Raw(ViewBag.SlurperExplanation)
                </div>
            }

            @if (ViewBag.Success)
            {
                <div class="alert alert-success">
                    <strong>?? Mission Accomplished!</strong> @ViewBag.Message
                </div>

                <div class="row mb-4">
                    <div class="col-12">
                        <h4>?? Investigation Process</h4>
                        <div class="alert alert-secondary">
                            @foreach (var step in ViewBag.ProcessingSteps)
                            {
                                <div class="extraction-step">
                                    <i class="fas fa-search"></i> @step
                                </div>
                            }
                        </div>
                    </div>
                </div>

                <div class="row mb-4">
                    <div class="col-md-6">
                        <div class="card slurp-effect">
                            <div class="card-header bg-secondary text-white">
                                <h4>?? Before: Encrypted Evidence</h4>
                            </div>
                            <div class="card-body">
                                <p>This is the raw JSON intelligence file we intercepted:</p>
                                <pre class="bg-dark text-light p-3"
                                    style="max-height: 400px; overflow-y: auto;"><code>@ViewBag.FormattedJson</code></pre>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="card">
                            <div class="card-header bg-success text-white">
                                <h4>????? After: Decoded Intelligence</h4>
                            </div>
                            <div class="card-body">
                                <p>Slurper successfully decoded <strong>@ViewBag.BookCount superhero profiles</strong> from the encrypted files:</p>
                                <div style="max-height: 400px; overflow-y: auto;">
                                    @foreach (var hero in ViewBag.BookList)
                                    {
                                        <div class="hero-display">
                                            <h5>????? @hero.codename</h5>
                                            <p><strong>Real Identity:</strong> @hero.real_name</p>
                                            <p><strong>Threat Level:</strong> <span class="badge bg-warning">@hero.threat_level</span></p>
                                            <p><strong>Base:</strong> @hero.base_location</p>
                                            <p><strong>Weakness:</strong> @hero.weakness</p>
                                            <small class="text-muted">@hero.origin_story</small>
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card mb-4">
                    <div class="card-header bg-info text-white">
                        <h4>?? Slurper Intelligence Analysis</h4>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6">
                                <div class="code-comparison">
                                    <div class="code-header">? Without Slurper (Manual Decoding)</div>
                                    <div class="code-content">
<span style="color: #569cd6;">// Manual JSON decoding - complex and brittle</span>
<span style="color: #ce9178;">var</span> json = File.ReadAllText(<span style="color: #ce9178;">"intelligence.json"</span>);
<span style="color: #ce9178;">var</span> data = JsonSerializer.Deserialize&lt;SuperheroDatabase&gt;(json);
<span style="color: #ce9178;">var</span> heroes = data.SuperheroDatabase.Heroes;

<span style="color: #569cd6;">// Need custom classes for each structure:</span>
<span style="color: #4ec9b0;">public class</span> <span style="color: #4ec9b0;">SuperheroDatabase</span> {
    <span style="color: #4ec9b0;">public</span> DatabaseInfo SuperheroDatabase { <span style="color: #569cd6;">get</span>; <span style="color: #569cd6;">set</span>; }
}

<span style="color: #4ec9b0;">public class</span> <span style="color: #4ec9b0;">DatabaseInfo</span> {
    <span style="color: #4ec9b0;">public</span> Hero[] Heroes { <span style="color: #569cd6;">get</span>; <span style="color: #569cd6;">set</span>; }
}
<span style="color: #569cd6;">// ...and many more classes needed!</span>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-6">
                                <div class="code-comparison">
                                    <div class="code-header">? With Slurper (Intelligence Extraction)</div>
                                    <div class="code-content">
<span style="color: #569cd6;">// Slurper - unified intelligence extraction</span>
<span style="color: #ce9178;">var</span> intelligence = jsonExtractor.ExtractFromFile(<span style="color: #ce9178;">"data.json"</span>);

<span style="color: #569cd6;">// Navigate with simple dot notation</span>
<span style="color: #ce9178;">dynamic</span> decoded = intelligence.First();
<span style="color: #ce9178;">var</span> heroes = decoded.superhero_database.heroes;

<span style="color: #569cd6;">// Access any property dynamically</span>
<span style="color: #4ec9b0;">foreach</span> (<span style="color: #ce9178;">var</span> hero <span style="color: #4ec9b0;">in</span> heroes) {
    Console.WriteLine($<span style="color: #ce9178;">"{hero.codename} - {hero.threat_level}"</span>);
}

<span style="color: #569cd6;">// No custom classes required!</span>
<span style="color: #569cd6;">// Works with any JSON structure!</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            }
            else
            {
                <div class="alert alert-danger">
                    <strong>?? Investigation Failed!</strong> @ViewBag.Message
                </div>
            }
        </div>
    </div>

    <div class="text-center">
        <div class="row">
            <div class="col-md-4">
                <a asp-controller="Superhero" asp-action="Index" class="btn btn-warning btn-lg w-100 mb-2">
                    ????? Access Full Superhero Database
                </a>
            </div>
            <div class="col-md-4">
                <a asp-controller="Home" asp-action="Index" class="btn btn-primary btn-lg w-100 mb-2">
                    ?? Return to Detective HQ
                </a>
            </div>
            <div class="col-md-4">
                <a asp-action="XmlDemo" class="btn btn-secondary btn-lg w-100 mb-2">
                    ?? Next Case: XML Archives
                </a>
            </div>
        </div>
    </div>
</div>